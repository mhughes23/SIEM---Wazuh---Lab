# Project 5: Custom Syslog Message & Wazuh Rule Creation

## Objective
This project demonstrates the creation of **custom Wazuh rules** for detecting organization-specific events.  
**Use Case:** Detect new user account creation on a Linux/Ubuntu agent and map it to MITRE ATT&CK for SOC analysis.

---

## Requirements
- **Wazuh Manager** installed and running
- **Ubuntu agent** connected to the Wazuh Manager
- Access to `local_rules.xml` for custom rule creation
- Basic knowledge of syslog and Linux commands

---

## Steps Taken

### Step 1: Select Use Case
- Event chosen: **New user creation** on Ubuntu
- Goal: Trigger an alert when a new user is added

### Step 2: Generate Test Event
1. On the Ubuntu agent:
    ```bash
    sudo useradd hackeruser
    ```
2. Verify that the event is captured in logs:
    ```bash
    tail -f /var/log/auth.log
    ```
    **Sample Output:**
    ```
    Aug 28 12:01:23 ubuntu sudo: useradd[1234]: new user: name=hackeruser
    ```

**Screenshot:**  
![Syslog Capture](screenshots/syslog_capture.png)

---

### Step 3: Access Wazuh Custom Rules
1. Navigate to **Wazuh Dashboard → Server Management → Rules**
2. Open **`local_rules.xml`** for editing

**Screenshot:**  
![Local Rules Access](screenshots/local_rules_access.png)

---

### Step 4: Add Custom Rule
Insert the following XML inside `local_rules.xml`:

```xml
<group name="custom,syslog,account_creation,persistence,">
  <rule id="100001" level="10">
    <if_sid>5902</if_sid>
    <description>Suspicious new user account created</description>
    <mitre>
      <id>T1136</id> <!-- MITRE ATT&CK: Create Account -->
    </mitre>
  </rule>
</group>
